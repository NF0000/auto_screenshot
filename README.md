# 電子書籍スクリーンショット自動化ツール

電子書籍のページを自動的にスクリーンショット撮影し、高品質なPDFファイルとして保存するPythonアプリケーションです。

## 機能

### 主要機能
- **自動スクリーンショット撮影**: 指定した範囲を定期的に自動撮影
- **画像編集機能**: 撮影した画像の編集・削除が可能
- **高画質キャプチャ**: 解像度スケーリングによる高品質撮影
- **PDF生成**: 撮影した画像を1つのPDFファイルに統合
- **範囲選択**: マウスで撮影範囲を直感的に指定
- **自動ページめくり**: 指定位置への自動クリックでページ送り
- **緊急停止機能**: Escapeキーで即座に処理を停止

### 画像編集機能
- サムネイル表示とプレビュー
- 画像の削除
- 高品質なPDF出力

## 必要条件

- **OS**: Windows 10/11 または macOS 10.14以上
- **Python**: 3.7以上

## インストール

### 1. リポジトリをクローン
```bash
git clone <repository-url>
cd Auto_screenshot
```

### 2. 依存関係をインストール
```bash
pip install -r requirements.txt
```

### 3. macOS固有の設定

macOSで実行する場合、以下の権限設定が必要です：

1. **アクセシビリティ権限**:
   - システム環境設定 → セキュリティとプライバシー → プライバシー → アクセシビリティ
   - ターミナル（またはPythonを実行するアプリ）を追加

2. **画面収録権限**:
   - システム環境設定 → セキュリティとプライバシー → プライバシー → 画面収録
   - ターミナル（またはPythonを実行するアプリ）を追加

### 依存パッケージ
- `pyautogui` - スクリーンショットとマウス自動化
- `Pillow` - 画像処理
- `pynput` - キーボード入力処理
- `reportlab` - PDF生成
- `pywin32` - Windows固有機能（Windows版のみ）
- `pyobjc-framework-Cocoa` - macOS固有機能（macOS版のみ）
- `pyobjc-framework-Quartz` - macOS高品質スクリーンショット（macOS版のみ）

## 使用方法

### 1. アプリケーション起動
```bash
python main.py
```

### 2. 基本設定
1. **PDFパス**: 保存先PDFファイルのパスを指定
2. **待機時間**: 各スクリーンショット間の間隔（秒）
3. **撮影枚数**: 撮影するページ数
4. **画質設定**: 解像度の拡大倍率

### 3. 撮影範囲の設定
1. 「撮影範囲を選択」ボタンをクリック
2. マウスドラッグで撮影したい範囲を選択
3. 選択した範囲が設定に表示されます

### 4. クリック位置の設定
1. 「クリック位置を設定」ボタンをクリック
2. ページめくりに使用する位置をクリック
3. 設定した位置が表示されます

### 5. 撮影開始
1. 「撮影開始」ボタンをクリック
2. 自動的にスクリーンショット撮影が開始されます
3. 緊急停止が必要な場合は **Escapeキー** を押してください

### 6. 画像編集とPDF保存
1. 撮影完了後、画像編集ウィンドウが表示されます
2. 不要な画像があれば削除できます
3. 「PDFとして保存」ボタンでPDFファイルを生成します

## キーボードショートカット

- **Escape**: 撮影処理の緊急停止

## インターフェース

アプリケーションは日本語インターフェースを使用しており、以下の要素が含まれます：

- 設定パネル（PDFパス、待機時間、撮影枚数、画質設定）
- 撮影範囲・クリック位置設定ボタン
- 現在の設定表示エリア
- 撮影進行状況表示

## 使用例

### 電子書籍のPDF化
1. 電子書籍アプリで読みたい本を開く
2. 本アプリで撮影範囲（ページ表示エリア）を選択
3. ページめくりボタンの位置を設定
4. 撮影枚数と待機時間を設定
5. 撮影開始で自動的にPDF化

## 注意事項

- Windows 10/11 および macOS 10.14以上で動作します
- 高解像度での撮影は処理時間が長くなる場合があります
- 撮影中は指定した範囲や位置を変更しないでください
- 緊急停止が必要な場合は必ずEscapeキーを使用してください
- macOSでは初回実行時にアクセシビリティ権限の許可が必要です

## 技術仕様

- **GUI**: tkinter
- **画像処理**: PIL/Pillow
- **自動化**: pyautogui
- **PDF生成**: reportlab
- **入力処理**: pynput

## ファイル構成

```
Auto_screenshot/
├── main.py              # メインアプリケーション
├── requirements.txt     # 依存関係
├── .gitignore          # Git除外ファイル
└── README.md           # このファイル
```

## トラブルシューティング

### よくある問題

1. **スクリーンショットが撮影できない**
   - 管理者権限で実行してみてください
   - セキュリティソフトがブロックしていないか確認してください

2. **画質が悪い**
   - 画質設定の倍率を上げてください
   - モニターの解像度設定を確認してください

3. **アプリケーションが応答しない**
   - Escapeキーで緊急停止してください
   - タスクマネージャーからプロセスを終了してください

## ライセンス

このプロジェクトは個人利用を目的としています。商用利用については別途ご相談ください。

## 貢献

バグ報告や機能改善の提案は、GitHubのIssuesから報告してください。

---

**作成者**: fuure  
**最終更新**: 2024年